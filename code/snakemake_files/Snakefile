bigdata = False
include: "param_snakefile"
#include: "wtcc_snakefile"
#include: "combined_snakefile"
#include: "matlab_snakefile"
#include: "crossover_snakefile"
#include: "impute_snakefile"
#include: "manip_snakefile"
#include: "ntr_snakefile"
#include: "fram_snakefile"
import math
import numpy as np

def file_len(fname):
    with open(fname) as f:
        for i, l in enumerate(f):
            pass
    return i


# # chunksize=10000
# # tot_p=996708
# # tot_chunk=math.ceil(tot_p/chunksize)+1
# # inf=[config["LDETECT_DIR"]+"fourier_ls-chr"+str(x)+".bed" for x in range(1,23)]
# # ld_no=[file_len(x) for x in inf]
# tot_chunk=np.max(ld_no)+1
tot_chunk=50
include: "kg_snakefile"
include: "kg_ld_snakefile"
#include: "genred_snakefile"
#include: "sim_snakefile"
#include: "trait_snakefile"
#include: "LD_snakefile"
#include: "direct_snakefile"
#include: "ldsc_snakefile"
#include: "rssp_snakefile"
#include: "grm_snakefile"

wildcard_constraints:
    clusterid="[0-9]+",
    trait="[a-z-]+",
    pop="EUR",
    chrom="[0-9]+",
    consortia="[a-z]+",
    useLDshrink="T|F"

#     pop="[A-Z]+",
#     N="0",
#     SNPCT="0"
    


localrules: all

rule all:
    input:
        expand(config["HDF5_DIR"]+"{pop}/{pop}.chr{chrom}.h5",pop="EUR",chrom=range(1,23)),
        expand(config["EVD_DIR"]+"chr{chrom}AF0SNP0N0_{consortia}O{trait}_{pop}_{useLDetect}_{pop}_{useLDshrink}.h5",consortia="bc",trait=["mchc","rdw","baso-p"],pop="EUR",chrom=range(1,23),useLDetect="T",useLDshrink="T")
